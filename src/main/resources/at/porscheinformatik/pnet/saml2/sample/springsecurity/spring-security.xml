<b:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:b="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/security https://www.springframework.org/schema/security/spring-security.xsd">

	<b:bean id="bootstrap"
		class="org.springframework.security.saml.SAMLBootstrap"></b:bean>

	<b:bean id="samlLogger"
		class="org.springframework.security.saml.log.SAMLDefaultLogger">
		<b:property name="logAllMessages" value="true" />
		<b:property name="logErrors" value="true" />
		<b:property name="logMessagesOnException" value="true" />
	</b:bean>

	<b:bean id="keyManager"
		class="org.springframework.security.saml.key.JKSKeyManager">
		<b:constructor-arg
			value="classpath:at/porscheinformatik/pnet/saml2/sample/springsecurity/saml2.keystore" />
		<b:constructor-arg type="java.lang.String"
			value="changeme" />
		<b:constructor-arg>
			<b:map>
				<b:entry key="saml2-sample" value="changeme" />
			</b:map>
		</b:constructor-arg>
		<b:constructor-arg type="java.lang.String"
			value="saml2-sample" />
	</b:bean>

	<b:bean id="idpMetadata"
		class="org.springframework.security.saml.metadata.ExtendedMetadataDelegate">
		<b:constructor-arg>
			<b:bean
				class="org.opensaml.saml2.metadata.provider.HTTPMetadataProvider">
				<b:constructor-arg
					value="https://qa-identity.auto-partner.net/identity/saml2">
				</b:constructor-arg>
				<b:constructor-arg>
					<!-- Timeout for metadata loading in ms -->
					<b:value type="int">
						5000
					</b:value>
				</b:constructor-arg>
				<b:property name="parserPool" ref="parserPool" />
			</b:bean>
		</b:constructor-arg>
	</b:bean>

	<b:bean id="metadataManager"
		class="org.springframework.security.saml.metadata.MetadataManager">
		<b:constructor-arg>
			<b:list></b:list>
		</b:constructor-arg>
	</b:bean>

	<b:bean id="contextProvider"
		class="org.springframework.security.saml.context.SAMLContextProviderImpl"></b:bean>

	<b:bean id="extendedMetadata"
		class="org.springframework.security.saml.metadata.ExtendedMetadata">
		<b:property name="signingKey" value="saml2-sample" />
		<b:property name="encryptionKey" value="saml2-sample" />
	</b:bean>

	<b:bean id="metadataGenerator"
		class="at.porscheinformatik.pnet.saml2.sample.springsecurity.PnetMetadataGenerator">

		<b:property name="entityBaseURL"
			value="https://localhost:8443/saml2">
		</b:property>

		<b:property name="entityId"
			value="https://localhost:8443/saml2">
		</b:property>

		<b:property name="wantAssertionSigned" value="true">
		</b:property>

		<b:property name="bindingsSSO">
			<b:list>
				<b:value>post</b:value>
			</b:list>
		</b:property>

		<b:property name="nameID">
			<b:list>
				<b:value>transient</b:value>
			</b:list>
		</b:property>

		<b:property name="extendedMetadata" ref="extendedMetadata"></b:property>
	</b:bean>

	<b:bean id="metadataGeneratorFilter"
		class="org.springframework.security.saml.metadata.MetadataGeneratorFilter">
		<b:constructor-arg ref="metadataGenerator"></b:constructor-arg>
	</b:bean>

	<b:bean id="metadataDisplayFilter"
		class="at.porscheinformatik.pnet.saml2.sample.springsecurity.PnetMetadataDisplayFilter">
		<b:property name="filterProcessesUrl" value="/saml2"></b:property>
	</b:bean>

	<b:bean id="samlEntryPoint"
		class="org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint">
		<b:property name="realmName" value="test">
		</b:property>
	</b:bean>

	<b:bean id="authProvider"
		class="org.springframework.security.authentication.AnonymousAuthenticationProvider">
		<b:constructor-arg value="test">
		</b:constructor-arg>
	</b:bean>

	<b:bean id="authManager"
		class="org.springframework.security.authentication.ProviderManager">
		<b:constructor-arg>
			<b:list>
				<b:ref bean="authProvider" />
			</b:list>
		</b:constructor-arg>
	</b:bean>

	<http entry-point-ref="samlEntryPoint"
		authentication-manager-ref="authManager">
		<custom-filter before="FIRST"
			ref="metadataGeneratorFilter" />
		<custom-filter after="FIRST" ref="metadataDisplayFilter" />
		<!-- <custom-filter after="BASIC_AUTH_FILTER" -->
		<!-- ref="samlFilter" /> -->



		<intercept-url pattern="/**" access="isAuthenticated()" />
	</http>
</b:beans>
